<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI Story Generator</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --bg:      #05050F;
    --card:    #0F0F26;
    --card2:   #13132E;
    --border:  #1E1E42;
    --purple:  #7C3AED;
    --violet:  #6D28D9;
    --gold:    #F59E0B;
    --teal:    #06B6D4;
    --green:   #10B981;
    --pink:    #EC4899;
    --white:   #FFFFFF;
    --off:     #E2E8F0;
    --muted:   #94A3B8;
    --dim:     #475569;
    --red:     #EF4444;
  }

  body {
    background: var(--bg);
    color: var(--off);
    font-family: 'DM Sans', sans-serif;
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* Stars */
  body::before {
    content: '';
    position: fixed; inset: 0;
    pointer-events: none; z-index: 0;
    background-image:
      radial-gradient(1px 1px at 8%  12%, rgba(255,255,255,.5) 0%, transparent 100%),
      radial-gradient(1px 1px at 22% 48%, rgba(255,255,255,.3) 0%, transparent 100%),
      radial-gradient(1px 1px at 38% 22%, rgba(255,255,255,.4) 0%, transparent 100%),
      radial-gradient(1px 1px at 55% 75%, rgba(255,255,255,.3) 0%, transparent 100%),
      radial-gradient(1px 1px at 72% 38%, rgba(255,255,255,.5) 0%, transparent 100%),
      radial-gradient(1px 1px at 88% 55%, rgba(255,255,255,.3) 0%, transparent 100%),
      radial-gradient(1px 1px at 14% 82%, rgba(255,255,255,.3) 0%, transparent 100%),
      radial-gradient(1px 1px at 48% 92%, rgba(255,255,255,.4) 0%, transparent 100%),
      radial-gradient(1px 1px at 92% 8%,  rgba(255,255,255,.4) 0%, transparent 100%),
      radial-gradient(2px 2px at 32% 58%, rgba(124,58,237,.4) 0%, transparent 100%),
      radial-gradient(2px 2px at 78% 28%, rgba(6,182,212,.3)  0%, transparent 100%);
  }

  .blob1 {
    position: fixed; top: -200px; left: -200px;
    width: 600px; height: 600px;
    background: radial-gradient(circle, rgba(124,58,237,.1) 0%, transparent 70%);
    pointer-events: none; z-index: 0;
  }
  .blob2 {
    position: fixed; bottom: -150px; right: -150px;
    width: 500px; height: 500px;
    background: radial-gradient(circle, rgba(6,182,212,.07) 0%, transparent 70%);
    pointer-events: none; z-index: 0;
  }

  .wrapper {
    position: relative; z-index: 1;
    max-width: 780px; margin: 0 auto;
    padding: 40px 20px 70px;
  }

  /* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
  .header { text-align: center; margin-bottom: 40px; }

  .badge {
    display: inline-block;
    padding: 5px 16px;
    border: 1px solid rgba(124,58,237,.5);
    border-radius: 100px;
    font-size: 11px; letter-spacing: 2px; font-weight: 600;
    color: var(--purple); background: rgba(124,58,237,.08);
    margin-bottom: 18px;
  }

  h1 {
    font-family: 'Playfair Display', serif;
    font-size: clamp(32px, 6vw, 54px);
    font-weight: 700; line-height: 1.1;
    background: linear-gradient(135deg, #fff 0%, #A78BFA 50%, #06B6D4 100%);
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    background-clip: text; margin-bottom: 12px;
  }

  .subtitle {
    color: var(--muted); font-size: 15px;
    font-weight: 300; max-width: 420px;
    margin: 0 auto; line-height: 1.7;
  }

  /* ‚îÄ‚îÄ CARD ‚îÄ‚îÄ */
  .card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 20px; padding: 28px;
    margin-bottom: 20px;
    position: relative; overflow: hidden;
  }
  .card::before {
    content: '';
    position: absolute; top: 0; left: 0; right: 0; height: 1px;
    background: linear-gradient(90deg, transparent, rgba(124,58,237,.6), transparent);
  }

  /* ‚îÄ‚îÄ INPUT ‚îÄ‚îÄ */
  .field-label {
    font-size: 11px; font-weight: 600;
    letter-spacing: 1.8px; text-transform: uppercase;
    color: var(--gold); margin-bottom: 10px; display: block;
  }

  .topic-input {
    width: 100%;
    background: rgba(255,255,255,.04);
    border: 1px solid var(--border);
    border-radius: 12px; padding: 14px 18px;
    color: var(--white); font-family: 'DM Sans', sans-serif;
    font-size: 16px; outline: none; transition: all .3s;
  }
  .topic-input:focus {
    border-color: var(--purple);
    background: rgba(124,58,237,.06);
    box-shadow: 0 0 0 3px rgba(124,58,237,.12);
  }
  .topic-input::placeholder { color: var(--dim); }
  .topic-input.shake {
    animation: shake .4s ease;
    border-color: var(--red) !important;
  }
  @keyframes shake {
    0%, 100% { transform: translateX(0); }
    25%       { transform: translateX(-6px); }
    75%       { transform: translateX(6px); }
  }

  /* ‚îÄ‚îÄ SECTION LABEL ‚îÄ‚îÄ */
  .section-label {
    font-size: 11px; font-weight: 600;
    letter-spacing: 1.8px; text-transform: uppercase;
    color: var(--dim); margin: 20px 0 11px; display: block;
  }

  /* ‚îÄ‚îÄ GENRES ‚îÄ‚îÄ */
  .genres {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 9px;
  }

  .genre-btn {
    background: rgba(255,255,255,.03);
    border: 1px solid var(--border);
    border-radius: 12px; padding: 13px 10px;
    color: var(--muted); font-family: 'DM Sans', sans-serif;
    font-size: 13px; font-weight: 500;
    cursor: pointer; transition: all .2s; text-align: center;
  }
  .genre-btn:hover {
    border-color: var(--purple); color: var(--off);
    background: rgba(124,58,237,.08); transform: translateY(-1px);
  }
  .genre-btn.active {
    background: rgba(124,58,237,.15);
    border-color: var(--purple); color: var(--white);
    box-shadow: 0 0 16px rgba(124,58,237,.2);
  }
  .genre-btn .em { display: block; font-size: 22px; margin-bottom: 5px; }

  /* ‚îÄ‚îÄ LENGTHS ‚îÄ‚îÄ */
  .lengths { display: flex; gap: 9px; }

  .len-btn {
    flex: 1;
    background: rgba(255,255,255,.03);
    border: 1px solid var(--border);
    border-radius: 10px; padding: 12px 8px;
    color: var(--muted); font-family: 'DM Sans', sans-serif;
    font-size: 13px; font-weight: 500;
    cursor: pointer; transition: all .2s; text-align: center;
  }
  .len-btn:hover { border-color: var(--teal); color: var(--off); }
  .len-btn.active {
    background: rgba(6,182,212,.12);
    border-color: var(--teal); color: var(--teal); font-weight: 600;
  }
  .len-sub { font-size: 11px; color: var(--dim); margin-top: 3px; }

  /* ‚îÄ‚îÄ GENERATE BUTTON ‚îÄ‚îÄ */
  .gen-btn {
    width: 100%; margin-top: 24px;
    background: linear-gradient(135deg, var(--purple), var(--violet));
    border: none; border-radius: 14px; padding: 17px;
    color: var(--white); font-family: 'DM Sans', sans-serif;
    font-size: 16px; font-weight: 600;
    cursor: pointer; transition: all .3s;
    position: relative; overflow: hidden; letter-spacing: .5px;
    box-shadow: 0 4px 20px rgba(124,58,237,.3);
  }
  .gen-btn:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 8px 32px rgba(124,58,237,.5);
  }
  .gen-btn:disabled { opacity: .6; cursor: not-allowed; transform: none !important; box-shadow: none; }
  .gen-btn::after {
    content: '';
    position: absolute; top: 0; left: -100%; width: 100%; height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,.12), transparent);
    transition: left .5s;
  }
  .gen-btn:hover::after { left: 100%; }

  /* ‚îÄ‚îÄ ERROR ‚îÄ‚îÄ */
  .error-box {
    display: none;
    background: rgba(239,68,68,.08);
    border: 1px solid rgba(239,68,68,.3);
    border-radius: 12px; padding: 14px 18px;
    color: #FCA5A5; font-size: 13px;
    line-height: 1.7; margin-top: 15px;
  }
  .error-box.show { display: block; }

  /* ‚îÄ‚îÄ LOADING ‚îÄ‚îÄ */
  .loading {
    display: none;
    justify-content: center; align-items: center;
    gap: 10px; padding: 44px;
  }
  .loading.show { display: flex; }

  .dot {
    width: 11px; height: 11px;
    border-radius: 50%;
    animation: bounce 1.3s infinite ease-in-out;
  }
  .d1 { background: var(--purple); }
  .d2 { background: var(--teal);   animation-delay: .2s; }
  .d3 { background: var(--gold);   animation-delay: .4s; }

  @keyframes bounce {
    0%, 80%, 100% { transform: translateY(0);     opacity: .4; }
    40%            { transform: translateY(-15px); opacity: 1;  }
  }

  .loading-txt {
    color: var(--muted); font-size: 14px;
    font-style: italic; margin-left: 6px;
  }

  /* ‚îÄ‚îÄ STORY CARD ‚îÄ‚îÄ */
  .story-card {
    display: none;
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 20px; padding: 30px;
    position: relative; overflow: hidden;
    animation: fadeUp .5s ease;
  }
  .story-card.show { display: block; }

  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(16px); }
    to   { opacity: 1; transform: translateY(0); }
  }

  .story-card::before {
    content: '';
    position: absolute; top: 0; left: 0; right: 0; height: 2px;
    background: linear-gradient(90deg, var(--purple), var(--teal), var(--gold));
  }

  .story-header {
    display: flex; justify-content: space-between;
    align-items: center; flex-wrap: wrap;
    gap: 10px; margin-bottom: 20px;
  }

  .meta { display: flex; gap: 8px; flex-wrap: wrap; }

  .pill {
    display: inline-flex; align-items: center;
    gap: 5px; padding: 5px 12px;
    border-radius: 100px; font-size: 12px; font-weight: 600;
  }
  .p-genre  { background: rgba(124,58,237,.15); color: #A78BFA; border: 1px solid rgba(124,58,237,.3); }
  .p-len    { background: rgba(6,182,212,.12);  color: var(--teal); border: 1px solid rgba(6,182,212,.3); }
  .p-ai     { background: rgba(16,185,129,.12); color: var(--green); border: 1px solid rgba(16,185,129,.3); }

  .actions { display: flex; gap: 8px; }

  .act-btn {
    background: rgba(255,255,255,.05);
    border: 1px solid var(--border);
    border-radius: 8px; padding: 8px 14px;
    color: var(--muted); font-family: 'DM Sans', sans-serif;
    font-size: 13px; cursor: pointer; transition: all .2s;
    display: flex; align-items: center; gap: 5px;
  }
  .act-btn:hover        { border-color: var(--purple); color: var(--off); }
  .act-btn.copied       { border-color: var(--green);  color: var(--green); }

  .story-divider {
    height: 1px;
    background: linear-gradient(90deg, var(--purple), rgba(124,58,237,.1));
    margin-bottom: 20px;
  }

  .story-text {
    font-size: 15px; line-height: 1.9;
    color: var(--off); font-weight: 300;
    white-space: pre-wrap;
  }

  /* ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ */
  .footer {
    text-align: center; padding-top: 44px;
    color: var(--dim); font-size: 13px; line-height: 1.8;
  }
  .footer b { color: var(--purple); }

  @media (max-width: 520px) {
    .genres { grid-template-columns: repeat(2, 1fr); }
    .card, .story-card { padding: 18px; }
  }
</style>
</head>
<body>
<div class="blob1"></div>
<div class="blob2"></div>

<div class="wrapper">

  <!-- HEADER -->
  <div class="header">
    <div class="badge">‚ú¶ POWERED BY GROQ + LLAMA 3.3 ¬∑ FREE FOREVER</div>
    <h1>AI Story<br>Generator</h1>
    <p class="subtitle">Enter any topic, pick a genre ‚Äî AI crafts a unique story in seconds.</p>
  </div>

  <!-- INPUT CARD -->
  <div class="card">
    <label class="field-label" for="topic">Your Story Topic</label>
    <input id="topic" class="topic-input" type="text"
      placeholder="e.g. A robot who learns to cook, A lost astronaut, A magical bookshop..."
      autocomplete="off"/>

    <span class="section-label">Choose Genre</span>
    <div class="genres">
      <button class="genre-btn active" data-genre="Adventure" onclick="pick(this,'genre')"><span class="em">‚öîÔ∏è</span>Adventure</button>
      <button class="genre-btn" data-genre="Comedy"    onclick="pick(this,'genre')"><span class="em">üòÇ</span>Comedy</button>
      <button class="genre-btn" data-genre="Mystery"   onclick="pick(this,'genre')"><span class="em">üîç</span>Mystery</button>
      <button class="genre-btn" data-genre="Sci-Fi"    onclick="pick(this,'genre')"><span class="em">üöÄ</span>Sci-Fi</button>
      <button class="genre-btn" data-genre="Horror"    onclick="pick(this,'genre')"><span class="em">üëª</span>Horror</button>
      <button class="genre-btn" data-genre="Romance"   onclick="pick(this,'genre')"><span class="em">üíñ</span>Romance</button>
    </div>

    <span class="section-label">Story Length</span>
    <div class="lengths">
      <button class="len-btn" data-words="150" data-label="Short"  onclick="pick(this,'len')">Short<div class="len-sub">~150 words</div></button>
      <button class="len-btn active" data-words="300" data-label="Medium" onclick="pick(this,'len')">Medium<div class="len-sub">~300 words</div></button>
      <button class="len-btn" data-words="500" data-label="Long"   onclick="pick(this,'len')">Long<div class="len-sub">~500 words</div></button>
    </div>

    <button class="gen-btn" id="genBtn" onclick="generate()">‚ú® &nbsp; Generate My Story</button>
    <div class="error-box" id="errBox"></div>
  </div>

  <!-- LOADING -->
  <div class="loading" id="loading">
    <div class="dot d1"></div>
    <div class="dot d2"></div>
    <div class="dot d3"></div>
    <span class="loading-txt">AI is writing your story‚Ä¶</span>
  </div>

  <!-- STORY -->
  <div class="story-card" id="storyCard">
    <div class="story-header">
      <div class="meta">
        <span class="pill p-genre" id="pillGenre">‚öîÔ∏è Adventure</span>
        <span class="pill p-len"   id="pillLen">üìÑ Medium</span>
        <span class="pill p-ai">ü§ñ Groq ¬∑ LLaMA 3.3</span>
      </div>
      <div class="actions">
        <button class="act-btn" id="copyBtn" onclick="copyStory()">üìã Copy</button>
        <button class="act-btn" onclick="generate()">üîÑ New Story</button>
      </div>
    </div>
    <div class="story-divider"></div>
    <div class="story-text" id="storyText"></div>
  </div>

  <div class="footer">
    <b>AI Story Generator</b> ¬∑ Workshop 2025<br>
    Python ¬∑ Flask ¬∑ Groq API ¬∑ LLaMA 3.3 70B ¬∑ HTML / CSS / JS
  </div>

</div>

<script>
  const EMOJIS = { Adventure:'‚öîÔ∏è', Comedy:'üòÇ', Mystery:'üîç', 'Sci-Fi':'üöÄ', Horror:'üëª', Romance:'üíñ' };
  let genre = 'Adventure', words = 300, lenLabel = 'Medium';

  function pick(btn, type) {
    document.querySelectorAll(type === 'genre' ? '.genre-btn' : '.len-btn')
      .forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    if (type === 'genre') genre = btn.dataset.genre;
    else { words = parseInt(btn.dataset.words); lenLabel = btn.dataset.label; }
  }

  async function generate() {
    const topic = document.getElementById('topic').value.trim();
    if (!topic) {
      const inp = document.getElementById('topic');
      inp.classList.add('shake'); inp.focus();
      setTimeout(() => inp.classList.remove('shake'), 500);
      return;
    }

    setLoading(true); hideErr();
    document.getElementById('storyCard').classList.remove('show');

    try {
      const res = await fetch('/api/generate', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ topic, genre, words })
      });

      const data = await res.json();
      if (!res.ok || data.error) throw new Error(data.error || 'Something went wrong. Try again.');

      document.getElementById('storyText').textContent = data.story;
      document.getElementById('pillGenre').textContent = `${EMOJIS[genre] || 'üìñ'} ${genre}`;
      document.getElementById('pillLen').textContent   = `üìÑ ${lenLabel}`;
      resetCopy();
      document.getElementById('storyCard').classList.add('show');
      setTimeout(() =>
        document.getElementById('storyCard').scrollIntoView({ behavior: 'smooth', block: 'start' }), 100);

    } catch(err) {
      showErr('‚ùå ' + (err.message || 'Something went wrong. Please try again.'));
    } finally {
      setLoading(false);
    }
  }

  function setLoading(on) {
    document.getElementById('loading').classList.toggle('show', on);
    const btn = document.getElementById('genBtn');
    btn.disabled = on;
    btn.innerHTML = on ? '‚è≥ &nbsp; Generating‚Ä¶' : '‚ú® &nbsp; Generate My Story';
  }

  function showErr(msg) { const b = document.getElementById('errBox'); b.textContent = msg; b.classList.add('show'); }
  function hideErr()    { document.getElementById('errBox').classList.remove('show'); }

  function copyStory() {
    navigator.clipboard.writeText(document.getElementById('storyText').textContent).then(() => {
      const btn = document.getElementById('copyBtn');
      btn.textContent = '‚úÖ Copied!'; btn.classList.add('copied');
      setTimeout(resetCopy, 2500);
    });
  }
  function resetCopy() {
    const btn = document.getElementById('copyBtn');
    btn.textContent = 'üìã Copy'; btn.classList.remove('copied');
  }

  document.getElementById('topic').addEventListener('keydown', e => {
    if (e.key === 'Enter') generate();
  });
</script>
</body>
</html>
